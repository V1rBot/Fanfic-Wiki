/* --- V9.3 Final Design System --- */
:root {
    --primary-color: #4dabf7;
    --accent-color: #3bc9db;
    --bg-color: #010409;
    --other-bg: rgba(18, 29, 48, 0.75);
    --text-color: #868e96; 
    --text-bright: #f8f9fa;
    --border-color: rgba(73, 171, 247, 0.2);
    --glow-color: rgba(73, 171, 247, 0.4);
    --font-main: 'Orbitron', sans-serif;
    --font-text: 'Roboto', sans-serif;
    --transition-speed: 0.4s;
}

* { margin: 0; padding: 0; box-sizing: border-box; }
html { height: 100%; }

body {
    font-family: var(--font-text);
    background-color: var(--bg-color);
    color: var(--text-color);
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    transition: background 0.8s ease-in-out;
    user-select: none;
    background-size: cover;
    background-position: center center;
}

.container { width: 100%; height: 100%; background: var(--panel-bg); backdrop-filter: blur(10px); padding: 20px; display: flex; flex-direction: column; position: relative; transition: background var(--transition-speed) ease, border var(--transition-speed) ease; }

/* --- V9.2: Тематические цвета и фоны --- */
/* цвет фона задней панели --panel-bg; цвет фона других эдементов --other-bg; цвет эдементов которые могут наложиться друг на друга вроде option --rgb-other-bg*/
.theme-default { --primary-color: #e0e0e0; --accent-color: #c00000; --panel-bg: rgba(20, 10, 10, 0.6); --other-bg: rgba(51, 26, 26, 0.8); --rgb-other-bg: rgb(51, 26, 26); --text-color: #969696; }
body.theme-default { background-image: url('./images/bg/bg-default.jpg'); background-position: right 50% top 30%; }

.theme-scp { --primary-color: #e0e0e0; --accent-color: #c00000; --panel-bg: rgba(20, 10, 10, 0.6); --other-bg: rgba(51, 26, 26, 0.8); --rgb-other-bg: rgb(51, 26, 26); --text-color: #969696; }
body.theme-scp { background-image: url('./images/bg/bg-scp.jpg'); background-position: right 50% top 30%; }

.theme-marvel { --primary-color: #e62429; --accent-color: #f78f3f; --panel-bg: rgba(30, 10, 20, 0.5); --other-bg: rgba(56, 19, 38, 0.8); --rgb-other-bg: rgb(56, 19, 38); --text-color: #f0e4d4; }
body.theme-marvel { background-image: url('./images/bg/bg-marvel.jpg'); background-position: right 50% top 20%;}

.theme-hp { --primary-color: #d3a625; --accent-color: #740001; --panel-bg: rgba(25, 15, 5, 0.4); --other-bg: rgba(27, 14, 14, 0.8); --rgb-other-bg: rgb(27, 14, 14); --text-color: #d8c9a8; }
body.theme-hp { background-image: url('./images/bg/bg-hp.jpg'); }

.theme-onepiece { --primary-color: #00a8ff; --accent-color: #f9d71c; --panel-bg: rgba(5, 20, 30, 0.6); --other-bg: rgba(9, 33, 49, 0.8); --rgb-other-bg: rgb(9, 33, 49); --text-color: #b4d8e7; }
body.theme-onepiece { background-image: url('./images/bg/bg-onepiece.jpg'); }

.theme-naruto { --primary-color: #6f9e3c; --accent-color: #c0392b; --panel-bg: rgba(15, 25, 15, 0.4); --other-bg: rgba(24, 41, 24, 0.8); --rgb-other-bg: rgb(24, 41, 24); --text-color: #e8e2d5; }
body.theme-naruto { background-image: url('./images/bg/bg-naruto.jpg'); }

.theme-bleach { --primary-color: #E0E0E0; --accent-color: #333333; --panel-bg: rgba(20, 20, 22, 0.6); --other-bg: rgba(42, 42, 46, 0.8); --rgb-other-bg: rgb(42, 42, 46); --text-color: #cccccc; }
body.theme-bleach { background-image: url('./images/bg/bg-bleach.jpg'); }

.theme-kim-possible { --primary-color: #ff00ff; --accent-color: #4800ff; --panel-bg: rgba(20, 10, 30, 0.6); --other-bg: rgba(46, 23, 68, 0.8); --rgb-other-bg: rgb(46, 23, 68); --text-color: #f0e4f4; }
body.theme-kim-possible { background-image: url(''); }

.theme-jackie-chan { --primary-color: #d2b48c; --accent-color: #dc143c; --panel-bg: rgba(30, 20, 10, 0.6); --other-bg: rgba(58, 39, 19, 0.8); --rgb-other-bg: rgb(58, 39, 19); --text-color: #f0e8e4; }
body.theme-jackie-chan { background-image: url(''); }

/* --- Шапка --- */
.main-header { display: flex; justify-content: center; align-items: center; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; transition: border-color var(--transition-speed) ease; flex-shrink: 0; position: relative; }
.logo { font-family: var(--font-main); font-weight: 500; font-size: 1.8em; color: var(--text-bright); text-shadow: 0 0 10px var(--glow-color); margin: 0; cursor: pointer; transition: all var(--transition-speed) ease; }
.logo:hover { color: var(--primary-color); text-shadow: 0 0 12px var(--primary-color); }

/* --- Основной контент --- */
main { flex-grow: 1; padding-top: 20px; overflow: hidden; display: flex; }
.view { display: none; height: 100%; width: 100%; }
.view.active-view { display: flex; }

.wiki-layout { display: flex; height: 100%; gap: 20px; width: 100%; }
.category-panel { width: 280px; flex-shrink: 0; overflow-y: auto; padding-right: 20px; border-right: 1px solid var(--border-color); transition: border-color var(--transition-speed) ease; }
.item-panel { flex-grow: 1; overflow-y: auto; padding-right: 15px; }

/* --- Category & Item Buttons --- */
.category-button, .subcategory-button, .item-button {
    user-select: none; 
    display: block; 
    width: 100%; 
    text-align: left; 
    font-family: var(--font-text); 
    font-size: 1em; 
    background: transparent; 
    border: none; 
    border-radius: 4px; 
    color: var(--text-color); 
    margin-bottom: 4px; 
    cursor: pointer; 
    transition: all var(--transition-speed) ease; 
    position: relative; 
}

.category-button:hover, .subcategory-button:hover, .item-button:hover { 
    background: var(--border-color); 
    color: var(--text-bright); 
}

.category-button.active, .subcategory-button.active {
    color: var(--primary-color);
}

/* --- Category Level Styles --- */
.level-0 {
    font-weight: bold;
    font-size: 1.05em;
    padding: 10px 10px 10px 20px; /* top right bottom left */
}
.level-1 {
    padding: 10px 10px 10px 35px;
}
.level-2 {
    padding: 10px 10px 10px 50px;
    font-size: 0.95em;
}

/* Left-side icons */
/* Left-side icons */
.level-0::before, .level-1::before, .level-2::before {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    font-size: 0.8em;
    color: var(--text-color);
    transition: color var(--transition-speed) ease, transform var(--transition-speed) ease;
}
.level-0::before {
    content: '\25B9'; /* ▹ */
    left: 5px;
}
.level-1::before {
    content: '\25CB'; /* ○ */
    left: 20px;
}
.level-2::before {
    content: '\25A1'; /* □ */
    left: 35px;
}
.level-0.active::before {
    content: '\25B8'; /* ▸ */
}
.level-1.active::before {
    content: '\25CF'; /* ● */
}
.level-2.active::before {
    content: '\25A0'; /* ■ */
}
.level-0.active::before, .level-1.active::before, .level-2.active::before {
    color: var(--primary-color);
}

/* Right-side arrow for expandable categories */
.has-children::after {
    content: '▸';
    position: absolute;
    right: 15px;
    top: 50%;
    transition: transform 0.2s ease;
    transform: translateY(-50%);
}
.has-children.active::after {
    transform: translateY(-50%) rotate(90deg);
}


.item-button { padding-left: 20px; padding-top: 10px; padding-bottom: 10px; font-size: 1em; background: rgba(255,255,255,0.03); margin-bottom: 8px; }
.item-button strong { color: var(--text-bright); font-weight: 600;}
.item-button span { font-size: 0.9em; opacity: 0.7;     color: var(--text-color)}

.item-panel-content { animation: slideIn 0.5s ease-out; }
.detail-main-content p,
.detail-main-content h2,
.sidebar-field strong,
.sidebar-field span {
    user-select: text;
}
@keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

.item-panel h2 { color: var(--primary-color); text-shadow: 0 0 8px var(--glow-color); margin-top: 0; margin-bottom: 15px; font-family: var(--font-main); font-weight: 500; transition: all var(--transition-speed) ease; }
.item-panel p { line-height: 1.7; font-size: 1.1em; color: var(--text-color); }
.back-button { user-select: none; font-family: var(--font-main); background: var(--border-color); border: none; color: var(--text-bright); padding: 8px 16px; border-radius: 4px; cursor: pointer; margin-bottom: 20px; transition: all var(--transition-speed) ease; }
.back-button:hover { background: var(--primary-color); color: var(--bg-color); }

.item-detail-layout { display: flex; gap: 20px; }
.detail-main-content { flex-grow: 1; }
.detail-sidebar { width: 280px; flex-shrink: 0; border-left: 1px solid var(--border-color); padding-left: 20px; }
.sidebar-image { width: 100%; border-radius: 5px; background-color: rgba(0, 0, 0, 0); margin-bottom: 15px; aspect-ratio: 1 / 1; object-fit: contain; }
.sidebar-fields { display: flex; flex-direction: column; gap: 10px; }
.sidebar-field { font-size: 0.9em; line-height: 1.4; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; }
.sidebar-field strong { color: var(--primary-color); display: block; margin-bottom: 2px; font-size: 1em; font-family: var(--font-main); font-weight: 500;}
.sidebar-field span { color: var(--text-color); display: block;}

.sidebar-image-container { position: relative; }
.image-prev-button, .image-next-button, .gallery-prev, .gallery-next {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background-color: rgba(0, 0, 0, 0.5);
    color: white;
    border: none;
    cursor: pointer;
    padding: 10px;
    font-size: 18px;
    z-index: 1;
    border-radius: 50%;
}
.image-prev-button { left: 5px; }
.image-next-button { right: 5px; }

.gallery-container { margin: 20px 0; border: 1px solid var(--border-color); padding: 10px; border-radius: 5px; overflow: auto; }
.gallery-main-view { position: relative; margin-bottom: 10px; }
.gallery-main-image { width: 100%; height: auto; max-height: 500px; object-fit: contain; border-radius: 4px; }
.gallery-nav { position: absolute; top: 50%; transform: translateY(-50%); background-color: rgba(0, 0, 0, 0.5); color: #fff; border: none; padding: 8px 12px; font-size: 1.5em; line-height: 1; cursor: pointer; z-index: 1; transition: background-color 0.3s; user-select: none; border-radius: 50%; }
.gallery-nav:hover { background-color: rgba(0, 0, 0, 0.8); }
.gallery-prev { left: 10px; }
.gallery-next { right: 10px; }
.gallery-thumbnails { display: flex; flex-wrap: wrap; gap: 5px; justify-content: center; }
.gallery-thumbnail { width: 60px; height: 60px; object-fit: cover; border-radius: 3px; cursor: pointer; border: 2px solid transparent; transition: border-color 0.3s; -webkit-user-drag: none; user-select: none; }
.gallery-thumbnail:hover { border-color: var(--accent-color); }
.gallery-thumbnail.active { border-color: var(--primary-color); }

.embedded-image { width: 100%; max-width: 100%; border-radius: 5px; margin: 15px 0; }

.no-copy { pointer-events: none; user-select: none; -webkit-user-drag: none; }

.clear-float { clear: both; }

.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(10, 15, 24, 0.8); backdrop-filter: blur(8px); display: flex; justify-content: center; align-items: center; z-index: 1000; transition: opacity 0.3s ease; }
.modal-overlay.hidden { opacity: 0; pointer-events: none; }
.modal-content { background: var(--panel-bg); border: 1px solid var(--border-color); border-radius: 8px; padding: 30px; width: 90%; max-width: 800px; box-shadow: 0 0 50px rgba(0,0,0,0.5); transition: transform 0.3s ease; }
.modal-overlay.hidden .modal-content { transform: scale(0.95); }
.modal-world-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin: 20px 0; }
.world-button-modal { font-family: var(--font-main); background: transparent; border: 1px solid var(--border-color); color: var(--text-color); padding: 20px; cursor: pointer; transition: all var(--transition-speed) ease; font-size: 1.1em; text-align: center; border-radius: 5px; }
.world-button-modal:hover { border-color: var(--primary-color); color: var(--primary-color); background: var(--border-color); transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }

.mode-switcher { position: fixed; bottom: 20px; left: 20px; z-index: 100; display: flex; align-items: center; font-family: var(--font-main); font-size: 0.9em; }
.toggle-label { color: var(--text-color); transition: color var(--transition-speed) ease; }
.toggle-checkbox { opacity: 0; width: 0; height: 0; }
.toggle-slider { width: 50px; height: 24px; background: #333; border-radius: 12px; margin: 0 10px; cursor: pointer; position: relative; transition: background var(--transition-speed) ease; }
.toggle-slider::before { content: ''; position: absolute; top: 3px; left: 4px; width: 18px; height: 18px; background: #fff; border-radius: 50%; transition: all var(--transition-speed) ease; }
.toggle-checkbox:checked ~ .toggle-slider { background: var(--primary-color); }
.toggle-checkbox:checked ~ .toggle-slider::before { transform: translateX(26px); background: var(--accent-color); } 
.toggle-checkbox:checked ~ .toggle-label:last-of-type { color: var(--text-bright); }
.toggle-checkbox:not(:checked) ~ .toggle-label:first-of-type { color: var(--text-bright); }

::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: var(--primary-color); }

.mobile-only-button, .header-spacer { display: none; }

@media (max-width: 768px) {
    .main-header { justify-content: space-between; }
    .mobile-only-button { display: block; background: transparent; border: none; color: var(--text-bright); font-size: 1.8em; padding: 0; cursor: pointer; }
    .header-spacer { display: block; width: 24px; }
    .wiki-layout { position: relative; overflow-x: hidden; }
    .category-panel, .item-panel { position: absolute; top: 0; left: 0; width: 100%; height: 100%; transition: transform 0.4s ease-in-out; border-right: none; padding-right: 0; }
    .wiki-layout.show-items .category-panel { transform: translateX(-100%); }
    .wiki-layout.show-items .item-panel { transform: translateX(0); }
    .item-panel { transform: translateX(100%); background: var(--other-bg); }
    #game-mode .item-panel { position: static; transform: none; } 
    .item-detail-layout { flex-direction: column-reverse; }
    .detail-sidebar { width: 100%; border-left: none; border-bottom: 1px solid var(--border-color); padding-left: 0; padding-bottom: 20px; margin-bottom: 20px; }
    .mode-switcher { bottom: 85px; }
}

#game-mode { display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; height: 100%; }
#game-mode h2 { font-family: var(--font-main); font-size: 2.5em; color: var(--primary-color); text-shadow: 0 0 15px var(--glow-color); margin-bottom: 20px; }
#game-mode p { font-size: 1.2em; max-width: 600px; line-height: 1.6; }
#game-mode.active-view { display: flex; }

.gallery-controls { display: flex; align-items: center; justify-content: center; gap: 10px; margin-top: 10px; }
.gallery-size-slider { width: 150px; }

/* --- Editor Mode Styles --- */
.hidden { display: none !important; }

#editor-password-modal .modal-content { max-width: 500px; text-align: center; }
#editor-password-input { width: 100%; padding: 12px; margin: 20px 0; background-color: var(--bg-color); border: 1px solid var(--border-color); color: var(--text-bright); font-size: 1.2em; border-radius: 4px; }
#editor-password-submit { width: 100%; padding: 12px; background-color: var(--primary-color); color: var(--bg-color); border: none; border-radius: 4px; font-family: var(--font-main); font-size: 1.2em; cursor: pointer; transition: background-color var(--transition-speed); }
#editor-password-submit:hover { background-color: var(--accent-color); }
.error-message { color: #e74c3c; margin-top: 10px; }

#editor-container { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background-color: rgba(0, 0, 0, 0.95); z-index: 2000; display: flex; flex-direction: column; color: var(--text-bright); }
#editor-container.hidden { display: none; }

.editor-header { display: flex; justify-content: space-between; align-items: center; padding: 20px 30px; background-color: var(--other-bg); border-bottom: 1px solid var(--primary-color); flex-shrink: 0; }
.editor-header h2 { font-family: var(--font-main); color: var(--primary-color); margin: 0; }
#editor-close-btn { background: transparent; border: 1px solid #c0392b; color: #c0392b; padding: 8px 16px; border-radius: 4px; cursor: pointer; transition: all var(--transition-speed); }
#editor-close-btn:hover { background: #c0392b; color: var(--text-bright); }

#editor-main-panel { padding: 0; flex-grow: 1; overflow-y: hidden; display: flex; flex-direction: column; }
.editor-content-wrapper { padding: 0; flex-grow: 1; overflow-y: auto; }
.editor-content-wrapper.scrollable { padding: 20px 30px; }
.editor-home-content { padding: 20px 30px; }

.editor-footer { padding: 10px 30px 20px 30px; background-color: rgba(1, 4, 9, 0.8); border-top: 1px solid var(--border-color); flex-shrink: 0; }

.editor-main-button { display: block; width: 100%; max-width: 400px; margin: 15px auto; padding: 20px; font-family: var(--font-main); font-size: 1.3em; background-color: var(--other-bg); border: 1px solid var(--border-color); color: var(--text-bright); border-radius: 5px; cursor: pointer; transition: all var(--transition-speed); }
.editor-main-button:hover { background-color: var(--primary-color); color: var(--bg-color); border-color: var(--primary-color); }

/* --- Editor Panel Styles --- */
.editor-panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding: 10px 30px; border-bottom: 1px solid var(--border-color); }
.editor-panel-header h3 { font-family: var(--font-main); color: var(--accent-color); margin: 0; }

#editor-back-btn { background: transparent; border: 1px solid var(--text-color); color: var(--text-color); padding: 6px 12px; border-radius: 4px; cursor: pointer; transition: all var(--transition-speed); }
#editor-back-btn:hover { background: var(--text-color); color: var(--bg-color); }

.editor-list-item { display: flex; align-items: center; background: var(--other-bg); padding: 10px 15px; border-radius: 4px; margin-bottom: 10px; border-left: 3px solid var(--primary-color); }
.editor-item-controls { display: flex; flex-direction: column; justify-content: center; margin-right: 15px; }
.editor-move-btn, .scaffold-toggle-btn { background: transparent; border: 1px solid var(--text-color); color: var(--text-color); cursor: pointer; padding: 2px 6px; font-size: 12px; line-height: 1; border-radius: 3px; font-family: monospace; }
.scaffold-toggle-btn { margin: auto 0; }
.editor-move-btn:hover:not(:disabled), .scaffold-toggle-btn:hover {
    background: var(--text-color);
    color: var(--bg-color);
}
.editor-move-btn:disabled { opacity: 0.3; cursor: not-allowed; }
.editor-move-btn[data-direction="up"] { margin-bottom: 4px; }
.editor-item-info { display: flex; flex-direction: column; flex-grow: 1; gap: 5px; }
.editor-item-info span { line-height: 1.4; }
.editor-item-info input, .editor-edit-fields input { background-color: var(--bg-color); border: 1px solid var(--primary-color); color: var(--text-bright); padding: 5px; border-radius: 3px; width: 100%; }

.editor-item-actions { display: flex; gap: 5px; margin-left: 15px; }
.editor-delete-btn, .editor-edit-btn, .editor-confirm-btn, .editor-cancel-btn { background: transparent; border: 1px solid var(--text-color); color: var(--text-color); padding: 5px 10px; font-size: 0.9em; border-radius: 3px; cursor: pointer; transition: all var(--transition-speed); }

.editor-edit-btn:hover, .editor-confirm-btn:hover { border-color: #2ecc71; color: #2ecc71; }
.editor-delete-btn:hover, .editor-cancel-btn:hover { border-color: #e74c3c; color: #e74c3c; }
.editor-delete-btn { border-color: #c0392b; color: #c0392b; }

.editor-form { display: flex; align-items: center; gap: 10px; margin-top: 15px; }
.editor-path-input-group { display: flex; align-items: center; gap: 5px; flex-grow: 1; }
.editor-path-input-group span { color: var(--text-color); }
.editor-path-input-group input { flex-grow: 1; }

.editor-form input { flex-grow: 0; padding: 10px; background-color: var(--bg-color); border: 1px solid var(--border-color); color: var(--text-bright); border-radius: 4px; }
.editor-form #new-world-id { flex-basis: 25%; }
.editor-path-input-group #new-world-folder { flex-basis: 50%; }
.editor-path-input-group #new-world-file { flex-basis: 50%; }

.editor-form button { padding: 10px 20px; background-color: var(--primary-color); color: var(--bg-color); border: none; border-radius: 4px; font-family: var(--font-main); cursor: pointer; transition: all var(--transition-speed); flex-shrink: 0; }

.editor-save-button {
    margin-right: 10px; /* Add space between buttons */
    padding: 10px 20px; 
    background-color: var(--primary-color); 
    color: var(--bg-color); 
    border: none; 
    border-radius: 4px; 
    font-family: var(--font-main); 
    cursor: pointer; 
    transition: all var(--transition-speed); 
}
.editor-save-button:disabled { background-color: var(--text-color); cursor: not-allowed; }
.editor-save-button:hover:not(:disabled) { background-color: var(--accent-color); }

.editor-save-area { display: flex; align-items: center; justify-content: center; margin-top: 20px; }

#save-status-indicator { margin-left: 15px; font-size: 1.5em; transition: opacity 1s ease-in-out; opacity: 1; }
#save-status-indicator.fade-out { opacity: 0; }
#save-status-indicator.success { color: #2ecc71; }
#save-status-indicator.error { color: #e74c3c; }

/* Modern Checkbox */
.delete-action-group {
    display: flex;
    align-items: center;
    gap: 10px;
}

.delete-files-checkbox {
    appearance: none;
    -webkit-appearance: none;
    width: 20px;
    height: 20px;
    border: 2px solid var(--text-color);
    border-radius: 4px;
    cursor: pointer;
    position: relative;
    transition: all var(--transition-speed) ease;
}

.delete-files-checkbox:checked {
    background-color: var(--primary-color);
    border-color: var(--primary-color);
}

.delete-files-checkbox:checked::before {
    content: '✔';
    font-size: 14px;
    color: var(--bg-color);
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

.delete-action-group label {
    cursor: pointer;
    user-select: none;
}

/* Modern Buttons */
.editor-reset-button {
    padding: 10px 20px;
    background-color: transparent;
    border: 1px solid var(--text-color);
    color: var(--text-color);
    border-radius: 4px;
    font-family: var(--font-main);
    cursor: pointer;
    transition: all var(--transition-speed);
}

.editor-reset-button:hover:not(:disabled) {
    background-color: var(--text-color);
    color: var(--bg-color);
}

.editor-reset-button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.editor-delete-btn {
    background-color: transparent;
    border: 1px solid #c0392b;
    color: #c0392b;
    padding: 5px 10px;
    font-size: 0.9em;
    border-radius: 3px;
    cursor: pointer;
    transition: all var(--transition-speed);
}

.editor-delete-btn:hover:not(:disabled) {
    background-color: #c0392b;
    color: var(--text-bright);
}

.editor-list-item.dragging {
    opacity: 0.5;
}

.editor-list-item.drag-over {
    border-top: 2px solid var(--primary-color);
}

/* Category Editor Styles */
.editor-category-header {
    display: flex;
    gap: 20px;
    margin-bottom: 20px;
    align-items: flex-end;
}

.editor-world-selector, .editor-theme-selector {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 5px;
}

.editor-world-selector label, .editor-theme-selector label {
    font-size: 0.9em;
    color: var(--text-color);
}

#world-select-for-categories, 
#world-theme-select, 
#category-select-for-items, 
#world-select-for-items {
    width: 100%;
    padding: 10px;
    background-color: var(--other-bg) !important;
    border: 1px solid var(--border-color);
    color: var(--text-bright);
    border-radius: 4px;
    margin-bottom: 0; /* Reset margin */
}

#world-select-for-categories option,
#world-theme-select option,
#category-select-for-items option,
#world-select-for-items option {
    background-color: var(--rgb-other-bg) !important;
    color: var(--text-bright) !important;
}

/* Keep margin for selects when they are not in the new header */
#category-select-for-items, #world-select-for-items {
    margin-bottom: 20px;
}

.category-editor-item {
    padding-left: 20px;
    border-left: 1px solid var(--border-color);
    margin-bottom: 10px;
}

.category-item-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 5px;
}

.add-subcategory-btn {
    background: transparent;
    border: 1px solid #2ecc71;
    color: #2ecc71;
    padding: 2px 6px;
    font-size: 16px;
    line-height: 1;
    border-radius: 3px;
    cursor: pointer;
    transition: all var(--transition-speed);
}

.add-subcategory-btn:hover {
    background: #2ecc71;
    color: var(--bg-color);
}

.editor-edit-fields {
    display: flex;
    flex-direction: column;
    gap: 10px;
    width: 100%;
}

.editor-edit-field {
    display: flex;
    flex-direction: row; /* Changed from column */
    align-items: center;   /* To vertically align label and input */
    gap: 10px;             /* Add some space between label and input */
}

.editor-edit-field strong {
    flex-shrink: 0; /* Prevent the label from shrinking */
    width: 80px;    /* Give it a fixed width for alignment */
}

.editor-edit-field input, .editor-edit-field .editor-path-input-group {
    flex-grow: 1; /* Allow the input to take remaining space */
}

.invalid-char-tooltip {
    position: absolute;
    background-color: #c0392b;
    color: white;
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 0.9em;
    z-index: 10;
    bottom: 100%;
    left: 0;
    margin-bottom: 5px;
    display: none;
    white-space: nowrap;
}

.invalid-char-tooltip.visible {
    display: block;
    animation: fadeInTooltip 0.3s ease-out;
}

@keyframes fadeInTooltip {
    from { opacity: 0; transform: translateY(5px); }
    to { opacity: 1; transform: translateY(0); }
}

#world-select-for-categories option:hover,
#world-theme-select option:hover,
#category-select-for-items option:hover,
#world-select-for-items option:hover {
    background-color: var(--primary-color) !important;
    color: var(--bg-color) !important;
}

/* --- New Category Editor Styles --- */

.category-add-form {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
    padding: 10px;
    background-color: var(--other-bg);
    border-radius: 4px;
}

.category-add-form input {
    flex-grow: 1;
    background-color: var(--bg-color);
    border: 1px solid var(--border-color);
    color: var(--text-bright);
    padding: 8px;
    border-radius: 3px;
}

.category-add-form button {
    background-color: var(--primary-color);
    color: var(--bg-color);
    border: none;
    padding: 8px 15px;
    border-radius: 3px;
    cursor: pointer;
    transition: background-color var(--transition-speed);
}

.category-add-form button:hover { background-color: var(--accent-color); }

.category-editor-item {
    background-color: var(--other-bg);
    border: 1px solid var(--border-color);
    border-left-width: 3px;
    border-left-color: var(--accent-color);
    padding: 10px;
    margin-bottom: 10px;
    border-radius: 4px;
}

.category-item-header .category-name {
    flex-grow: 1;
    color: var(--text-bright);
    font-weight: 500;
}

.category-item-header.editing input {
    flex-grow: 1;
    margin-right: 10px;
}

.sub-add-form {
    margin-top: 10px;
    padding-left: 20px;
}

.category-editor-item .editor-move-btn {
    font-size: 16px;
    padding: 2px 8px;
}

.category-editor-item.dragging {
    opacity: 0.4;
    border-style: dashed;
}

.category-editor-item.drag-over {
    border-top: 2px solid var(--primary-color);
    margin-top: -2px;
}